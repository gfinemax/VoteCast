# RHA VoteCast - 제품 요구사항 정의서 (PRD)

## 1. 개요 (Overview)
**제품명:** RHA VoteCast (Regional Housing Association VoteCast)
**목적:** 지역주택조합 총회의 안건별 투표 결과를 실시간으로 집계하고, 이를 대형 스크린을 통해 조합원들에게 투명하고 시각적으로 전달하기 위한 총회 운영 지원 시스템입니다.
**대상 사용자:**
- **관리자 (Admin):** 총회 진행 요원, 투표 집계 담당자, 화면 송출 담당자 (Director)
- **입구 안내 요원 (Staff):** 조합원 입장 확인(Check-in) 담당
- **청중 (Audience):** 총회 참석 조합원

## 2. 핵심 기능 (Key Features)

### 2.1 입구 안내 데스크 (Check-in Station) [NEW]
- **총회 선택 (Meeting Selector) [NEW]:**
    - 화면 상단 드롭다운을 통해 입장 처리를 진행할 '총회(폴더)'를 선택합니다.
    - 선택된 총회에 한해서만 출석 데이터가 기록되고 통계가 표시됩니다.
- **조합원 검색 및 입장:**
    - 동/호수 또는 성명으로 조합원을 신속하게 검색합니다.
    - **다양한 체크인 옵션:** 직접 / 대리 / 서면 중 선택하여 입장 처리합니다. **[UPDATED]**
    - 버튼 클릭 시 즉시 상태가 변경되며, 실수 방지를 위해 명확한 색상(통일된 녹색)과 배지를 제공합니다.
- **모바일 성원 대시보드 (Mobile Sticky Dashboard) [NEW]:**
    - 화면 상단에 고정된 헤더를 통해 스크롤 중에도 항상 전체 집계 현황을 확인합니다.
    - **상세 분할:** 직접 / 대리 / 서면 인원을 실시간으로 구분하여 표시합니다.
    - **성원 충족 시각화:**
        - **직접참석율(20%):** 달성 시 '충족 OK' 배지와 함께 녹색 그래프로 전환됩니다.
        - **전체 성원율:** 과반수 및 2/3 지점을 마커로 표시하여 개회 가능 여부를 직관적으로 보여줍니다.

### 2.2 관리자 패널 (Admin Panel)
- **안건 관리 (Agenda Management) [UPDATED]:**
    - **총회(폴더) 관리:** 여러 건의 총회를 '폴더' 형태로 생성하고 관리할 수 있습니다. (예: 정기총회, 임시총회 분리)
    - **동적 안건 추가:** 각 총회 폴더 내에 안건을 실시간으로 추가할 수 있습니다.
    - **파일 업로드 강화:** PDF 업로드 시 **원본 파일명을 보존 및 표시**하여 관리 효율성을 증대합니다. **[NEW]**
    - **순서 관리:** 최신 총회가 상단에 위치하며, 안건은 추가된 순서대로 정렬됩니다.
    - **컴팩트 UI:** 접기/펼치기 기능을 통해 많은 안건을 효율적으로 관리할 수 있습니다.
- **성원(참석) 집계:**
    - 총 조합원 수 설정 기능.
    - **[자동/독립]** 입구 체크인 스테이션에서 입력된 데이터(직접/대리/서면)가 **선택된 총회(폴더)별로 독립적으로** 실시간 집계됩니다. **[UPDATED]**
    - 서면 결의자 수도 체크인 데이터와 연동되므로 입구 입력 시 자동 집계됩니다.
- **투표 결과 입력:**
    - 찬성, 반대, 기권/무효 표 수를 입력합니다.
    - **유효성 검사:** 입력된 총 투표 수와 참석자 수(성원)가 일치하는지 실시간으로 검증하고, 불일치 시 경고를 표시합니다.
    - **의결 확정 (Vote Snapshot) [NEW]:**
        - **수동 트리거:** 관리자가 [의결 확정] 버튼을 클릭하는 순간의 '성원'과 '투표 결과'를 스냅샷 형태로 영구 저장(박제)합니다.
        - **결과 고정:** 의결 후 성원이 변경되어도, 확정된 안건의 결과 화면은 변하지 않습니다.
        - **초기화(Reset):** 테스트 또는 실수 입력 시 [확정 취소]를 통해 스냅샷을 삭제하고 실시간 집계 모드로 되돌릴 수 있습니다.
- **결과 송출 제어:**
    - 집계가 완료된 결과를 '송출 화면'으로 즉시 반영(Publish)하는 기능을 제공합니다.
    - 유효성 검사 실패 시 송출 전 재확인 경고를 띄웁니다.

### 2.3 송출 화면 (Projector View)
- **실시간 결과 표시:**
    - 관리자가 송출한 안건의 제목, 총 참석 수, 찬성/반대/기권 수를 대시보드 형태로 시각화합니다.
    - 숫자는 큰 폰트로 가독성을 극대화합니다.
- **가결/부결 판정:**
    - 과반수 알고리즘(또는 설정된 로직)에 따라 가결(PASSED) 또는 부결(REJECTED) 여부를 자동으로 판정합니다.
    - 결과에 따라 직관적인 스탬프 애니메이션과 컬러(녹색/적색)를 적용하여 결과를 선포합니다.
- **선언문 자동 생성:**
    - "제N호 안건은 ... 가결되었음을 선포합니다"와 같은 공식 선언 문구를 자동으로 생성하여 표시합니다.
- **화면 전환 최적화 (Smooth Transition) [NEW]:**
    - **레이어 중심 설계:** 성원보고, 안건설명, 투표결과 화면을 독립적인 레이어로 생성하여 DOM에 상주(Persistent Rendering)시킵니다.
    - **부드러운 전환:** 모드 변경 시 CSS Cross-fade 효과를 적용(500ms)하여 시각적 안정감을 제공합니다.
    - **로딩 지연 제거:** 자료(PDF)가 백그라운드에서 미리 로드되어 있어 전환 즉시 발표가 가능합니다.

## 3. 기술 사양 (Technical Specifications)
- **Frontend Framework:** Next.js 14 (App Router)
- **Styling:** Tailwind CSS (Modern, Clean UI)
- **Icons:** Lucide-react
- **Platform:** Web-based application (Responsive, optimize for Desktop Admin & Large Screen Display)
- **Special Feature:** Persistent Layered Rendering (for zero-latency transitions) **[NEW]**

## 4. 사용자 플로우 (User Flow)
1.  **입장 시작:** 입구 안내 요원이 태블릿/PC로 조합원 입장을 처리합니다. (실시간 카운트 증가)
2.  **총회 시작:** 관리자는 송출 화면에 '실시간 입장 현황'을 띄워 분위기를 조성합니다.
3.  **성원 확정:** 관리자가 서면 결의 수를 최종 입력하고 성원을 확정 선포합니다.
4.  **안건 진행:** 관리자가 '안건 설명(PPT)' 모드로 화면을 전환하여 발표합니다.
5.  **투표:** 투표 종료 후 개표 결과를 입력합니다.
6.  **결과 발표:** 관리자가 '결과(Result)' 모드로 전환하여 가/부결을 송출합니다.

## 5. 향후 개선 사항 (Future Roadmap)
- 다중 클라이언트 연동 (관리자 화면과 송출 화면을 별도 기기에서 제어하도록 WebSocket 도입)
- [완료] 안건 동적 추가/수정/삭제 기능
- 다중 클라이언트 연동 심화 (권한 분리 등)
- 상세 로그 및 결과 리포트 PDF 출력 기능
